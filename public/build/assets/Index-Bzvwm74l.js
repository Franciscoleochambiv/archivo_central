import{f as h,o as f,a as N,u as z,Z as M,w as B,b as i,i as F,F as $,m as C,t as D,l as I,y as v}from"./app-DpVbqR-c.js";import{_ as P}from"./AuthenticatedLayout-kXzuiwCY.js";import{E as A}from"./exceljs.min--a27flyP.js";import{S as R}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-C-M4qhqN.js";import"./Chat-Bnf5azSk.js";import"./Ia-DSbK9_Ov.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const L={class:"flex h-screen bg-gray-50"},j={class:"w-1/4 p-6 border-r border-gray-300 bg-white shadow-md rounded-lg"},V={class:"mb-6"},W=["value"],G={class:"grid grid-cols-1 gap-4 mb-6"},H=["value"],q=["value"],X={class:"flex-1 p-6 overflow-auto"},Y={class:"w-full text-sm text-left text-gray-500 bg-white rounded-lg shadow-sm"},J={class:"text-xs text-gray-700 uppercase bg-gray-100"},K={data(){return{tiposReporte:[{label:"General de Expedientes",value:"oficina"},{label:"Por Oficina",value:"oficina"}],filtros:{oficina_id:"",entidad_id:"1"},oficinas:[],entidades:[],dataReportes:[],headers:[]}},methods:{async cargarMaestros(){const d=await v.get("/api/oficinaexcel");this.oficinas=d.data;const r=await v.get("/api/entidades");this.entidades=r.data},async fetchReporte(){try{const d=await v.get(`/api/reportes/${this.reporteSeleccionado}`,{params:this.filtros});console.log(d.data),this.dataReportes=d.data,this.headers=Object.keys(this.dataReportes[0]||{})}catch{R.fire("Error","No se pudo cargar el reporte","error")}},async exportarReporte(){try{const r=(await v.get(`/api/reportes/${this.reporteSeleccionado}`,{params:this.filtros})).data;if(!r||r.length===0){R.fire("Sin datos","No hay información para exportar","info");return}const o=new A.Workbook,e=o.addWorksheet("Reporte"),a=new Date,b=`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getFullYear()} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`;e.addRow(["Municipalidad Distrital de Colquemarca"]),e.addRow(["Fecha de Impresion: ",b]),e.addRow([]);const s=e.addRow(["REPORTE DE EXPEDIENTES REGISTRADOS"]);e.mergeCells(`A${s.number}:P${s.number}`),s.getCell(1).alignment={horizontal:"center"},s.getCell(1).font={bold:!0,size:14},e.addRow([]);const x={type:"pattern",pattern:"solid",fgColor:{argb:"F2DCDB"}},S={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},m=[{key:"nro_archivo",header:"Nro. Archivador"},{key:"unidad_conservacion",header:"Unidad de Conservación"},{key:"serie_documental",header:"Serie Documental"},{key:"nro_comprobantes",header:"Nro. Documento"},{key:"ubicacion_estante",header:"Ubicación/Estante"},{key:"valor_serie_documental",header:"Valor Serie Doc."},{key:"folios",header:"Folios"},{key:"soporte_papel",header:"Soporte"},{key:"es_copia_original",header:"Condición de Soporte"},{key:"anio_extremo_inicio",header:"Año Extremo Inicio"},{key:"anio_extremo_fin",header:"Año Extremo Fin"},{key:"color",header:"Color"},{key:"observaciones",header:"Observaciones"},{key:"estado_archivador",header:"Estado Archivador"},{key:"ubicacion_actual",header:"Ubicación Actual"}],c=["Item",...m.map(l=>l.header)],u={};r.forEach(l=>{const n=l.oficina;u[n]||(u[n]=[]),u[n].push(l)});for(const l in u){e.addRow([]);const n=u[l][0];[`Oficina: ${n.oficina}`,`Periodo: ${n.periodo}`,`Año de Elaboración: ${n.anio_elaboracion}`,`Sección: ${n.seccion}`,`Fechas Extremas: ${n.fechas_extremos}`].forEach(y=>{const _=e.addRow([y]);e.mergeCells(`A${_.number}:P${_.number}`),_.getCell(1).font={bold:!0},_.getCell(1).alignment={horizontal:"left"}}),e.addRow(c).eachCell(y=>{y.fill=x,y.font={bold:!0},y.alignment={horizontal:"center",wrapText:!0},y.border=S});let T=1;u[l].forEach(y=>{const _=[T++];m.forEach(g=>{let w=y[g.key];g.key==="es_copia_original"&&(w=w?"ORIGINAL":"COPIA"),_.push(w)}),e.addRow(_)})}e.columns=c.map((l,n)=>({width:[8,8,25,35,20,20,8,10,10,10,15,15,10,30,8,10][n]||15}));const k=await o.xlsx.writeBuffer(),p=new Blob([k],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=document.createElement("a");t.href=URL.createObjectURL(p),t.download=`Reporte_${this.reporteSeleccionado}.xlsx`,t.click()}catch(d){console.error("Error al generar Excel:",d),R.fire("Error","No se pudo generar el reporte","error")}},async exportarReporte78(){try{const r=(await v.get(`/api/reportes/${this.reporteSeleccionado}`,{params:this.filtros})).data;if(!r||r.length===0){R.fire("Sin datos","No hay información para exportar","info");return}const o=new A.Workbook,e=o.addWorksheet("Reporte"),a=new Date,b=`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getFullYear()} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`;e.addRow(["Municipalidad Distrital de Colquemarca"]),e.addRow(["Fecha de Impresion: ",b]),e.addRow([]);const s=e.addRow(["REPORTE DE EXPEDIENTES REGISTRADOS"]);e.mergeCells(`A${s.number}:U${s.number}`),s.getCell(1).alignment={horizontal:"center"},s.getCell(1).font={bold:!0,size:14},e.addRow([]);const x={type:"pattern",pattern:"solid",fgColor:{argb:"F2DCDB"}},S={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},m=["IOtem","nro_archivo","unidad_conservacion","serie_documental","nro_comprobantes","ubicacion_estante","valor_serie_documental","folios","soporte_papel","es_copia_original","anio_extremo_inicio","anio_extremo_fin","color","observaciones","estado_archivador","ubicacion_actual"],c={};r.forEach(t=>{const l=`${t.oficina}|${t.periodo}|${t.anio_elaboracion}|${t.seccion}|${t.fechas_extremos}`;c[l]||(c[l]=[]),c[l].push(t)});for(const t in c){const[l,n,E,O,T]=t.split("|");e.addRow([]),[`Oficina: ${l}`,`Periodo: ${n}`,`Año de Elaboración: ${E}`,`Sección: ${O}`,`Fechas Extremas: ${T}`].forEach(g=>{const w=e.addRow([g]);e.mergeCells(`A${w.number}:P${w.number}`),w.getCell(1).font={bold:!0},w.getCell(1).alignment={horizontal:"left"}}),e.addRow(m).eachCell(g=>{g.fill=x,g.font={bold:!0},g.alignment={horizontal:"center",wrapText:!0},g.border=S}),c[t].forEach(g=>{e.addRow(m.map(w=>g[w]))})}e.columns=[{key:"item",width:10},{key:"nro_archivo",width:15},{key:"unidad_conservacion",width:25},{key:"serie_documental",width:30},{key:"nro_comprobantes",width:20},{key:"ubicacion_estante",width:20},{key:"valor_serie_documental",width:10},{key:"folios",width:10},{key:"soporte_papel",width:15},{key:"es_copia_original",width:15},{key:"anio_extremo_inicio",width:15},{key:"anio_extremo_fin",width:15},{key:"color",width:10},{key:"observaciones",width:30},{key:"estado_archivador",width:15},{key:"ubicacion_actual",width:20}];const u=await o.xlsx.writeBuffer(),k=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=document.createElement("a");p.href=URL.createObjectURL(k),p.download=`Reporte_${this.reporteSeleccionado}.xlsx`,p.click()}catch(d){console.error("Error al generar Excel:",d),R.fire("Error","No se pudo generar el reporte","error")}},async exportarReporte99988(){try{const r=(await v.get(`/api/reportes/${this.reporteSeleccionado}`,{params:this.filtros})).data;if(!r||r.length===0){R.fire("Sin datos","No hay información para exportar","info");return}const o=new A.Workbook,e=o.addWorksheet("Reporte"),a=new Date,b=`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getFullYear()} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`;e.addRow(["Municipalidad Distrital de Colquemarca"]),e.addRow(["Fecha de Impresion: ",b]),e.addRow([]);const s=e.addRow(["REPORTE DE EXPEDIENTES REGISTRADOS"]);e.mergeCells(`A${s.number}:V${s.number}`),s.getCell(1).alignment={horizontal:"center"},s.getCell(1).font={bold:!0,size:14},e.addRow([]);const x={type:"pattern",pattern:"solid",fgColor:{argb:"F2DCDB"}},S={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},m=["entidad","periodo","anio_elaboracion","seccion","fechas_extremos","item","nro_archivo","unidad_conservacion","serie_documental","nro_comprobantes","ubicacion_estante","valor_serie_documental","folios","soporte_papel","es_copia_original","anio_extremo_inicio","anio_extremo_fin","color","observaciones","estado_archivador","ubicacion_actual"],c={};r.forEach(t=>{c[t.oficina]||(c[t.oficina]=[]),c[t.oficina].push(t)});for(const t in c)e.addRow([]),e.addRow([t]),e.addRow(m).eachCell(n=>{n.fill=x,n.font={bold:!0},n.alignment={horizontal:"center",wrapText:!0},n.border=S}),c[t].forEach(n=>{e.addRow(m.map(E=>n[E]))});e.columns.forEach((t,l)=>{let n=10;t.eachCell({includeEmpty:!0},E=>{const O=E.value?E.value.toString():"";n=Math.max(n,O.length)}),t.width=n+2});const u=await o.xlsx.writeBuffer(),k=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=document.createElement("a");p.href=URL.createObjectURL(k),p.download=`Reporte_${this.reporteSeleccionado}.xlsx`,p.click()}catch(d){console.error("Error al generar Excel:",d),R.fire("Error","No se pudo generar el reporte","error")}},async exportarReporte8888(){try{const d=await v.get(`/api/reportes/${this.reporteSeleccionado}`,{params:this.filtros});console.log("estamos en exportar excel ");const r=d.data;if(!r||r.length===0){R.fire("Sin datos","No hay información para exportar","info");return}const o=new A.Workbook,e=o.addWorksheet("Reporte"),a=new Date,b=`${a.getDate().toString().padStart(2,"0")}/${(a.getMonth()+1).toString().padStart(2,"0")}/${a.getFullYear()} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}:${a.getSeconds().toString().padStart(2,"0")}`;e.addRow(["Municipalidad Distrital de Colquemarca "]),e.addRow(["Fecha de Impresion: ",b]),e.addRow([]);const s=e.addRow(["REPORTE DE EXPEDIENTES REGISTRADOS"]);e.mergeCells(`A${s.number}:V${s.number}`),s.getCell(1).alignment={horizontal:"center"},s.getCell(1).font={bold:!0,size:14},s.eachCell(t=>{t.font={bold:!0,size:12}}),e.addRow([]);const x={type:"pattern",pattern:"solid",fgColor:{argb:"F2DCDB"}},S={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},m=Object.keys(r[0]);e.addRow(m).eachCell(t=>{t.fill=x,t.font={bold:!0},t.alignment={horizontal:"center",wrapText:!0},t.border=S}),r.forEach(t=>{e.addRow(m.map(l=>t[l]))}),e.columns.forEach(t=>{t.width=20});const u=await o.xlsx.writeBuffer(),k=new Blob([u],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=document.createElement("a");p.href=URL.createObjectURL(k),p.download=`Reporte_${this.reporteSeleccionado}.xlsx`,p.click()}catch(d){console.error("Error al generar Excel:",d),R.fire("Error","No se pudo generar el reporte","error")}}},mounted(){this.cargarMaestros()}},Z=Object.assign(K,{__name:"Index",setup(d){return(r,o)=>(f(),h($,null,[N(z(M),{title:"Reportes Documentales"}),N(P,null,{default:B(()=>[i("div",L,[i("div",j,[o[11]||(o[11]=i("h1",{class:"text-2xl font-bold text-gray-800 mb-6"},"Seleccionar Reporte",-1)),i("div",V,[o[5]||(o[5]=i("label",{class:"block text-sm font-semibold text-gray-600 mb-2"},"Tipo de Reporte",-1)),F(i("select",{"onUpdate:modelValue":o[0]||(o[0]=e=>r.reporteSeleccionado=e),class:"text-sm w-full px-4 py-2 border border-red-300 rounded-lg focus:outline-none focus:border-red-500 hover:shadow"},[(f(!0),h($,null,C(r.tiposReporte,e=>(f(),h("option",{key:e.value,value:e.value},D(e.label),9,W))),128))],512),[[I,r.reporteSeleccionado]])]),i("div",G,[i("div",null,[o[7]||(o[7]=i("label",{class:"block text-sm font-semibold text-gray-600 mb-2"},"Oficina",-1)),F(i("select",{"onUpdate:modelValue":o[1]||(o[1]=e=>r.filtros.oficina_id=e),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-red-500"},[o[6]||(o[6]=i("option",{value:""},"Todas las oficinas",-1)),(f(!0),h($,null,C(r.oficinas,e=>(f(),h("option",{key:e.id,value:e.id},D(e.nombre),9,H))),128))],512),[[I,r.filtros.oficina_id]])]),i("div",null,[o[9]||(o[9]=i("label",{class:"block text-sm font-semibold text-gray-600 mb-2"},"Entidad",-1)),F(i("select",{"onUpdate:modelValue":o[2]||(o[2]=e=>r.filtros.entidad_id=e),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-red-500"},[o[8]||(o[8]=i("option",{value:""},"Todas las entidades",-1)),(f(!0),h($,null,C(r.entidades,e=>(f(),h("option",{key:e.id,value:e.id},D(e.nombre),9,q))),128))],512),[[I,r.filtros.entidad_id]])])]),i("button",{onClick:o[3]||(o[3]=(...e)=>r.fetchReporte&&r.fetchReporte(...e)),class:"w-full bg-red-400 hover:bg-red-600 text-white py-3 rounded-md font-semibold shadow-md mb-2"}," Cargar Reporte "),i("button",{onClick:o[4]||(o[4]=(...e)=>r.exportarReporte&&r.exportarReporte(...e)),class:"w-full bg-gray-400 hover:bg-gray-700 rounded-md flex items-center justify-center py-2 text-xs text-white"},o[10]||(o[10]=[i("span",null,"Exportar Excel",-1)]))]),i("div",X,[i("table",Y,[i("thead",J,[i("tr",null,[(f(!0),h($,null,C(r.headers,e=>(f(),h("th",{key:e,class:"py-2 px-4"},D(e),1))),128))])]),i("tbody",null,[(f(!0),h($,null,C(r.dataReportes,(e,a)=>(f(),h("tr",{key:a,class:"border-b hover:bg-gray-50"},[(f(!0),h($,null,C(Object.values(e),b=>(f(),h("td",{key:b,class:"py-2 px-4"},D(b),1))),128))]))),128))])])])])]),_:1})],64))}}),de=U(Z,[["__scopeId","data-v-a98adf91"]]);export{de as default};
