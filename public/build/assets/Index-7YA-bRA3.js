import{f as s,o as a,a as m,u as y,Z as h,w as x,b as o,i as f,F as i,m as n,t as u,l as b,y as c}from"./app-CfL62DiI.js";import{_ as v}from"./AuthenticatedLayout-QePhxG6N.js";import{E as w}from"./exceljs.min-CeCuBhyW.js";import{S as g}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-CM4Kn49N.js";import"./Chat-Dt6yl0WE.js";import"./Ia-C-VnDNBP.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const k={class:"flex h-screen bg-gray-50"},E={class:"w-1/4 p-6 border-r border-gray-300 bg-white shadow-md rounded-lg"},S={class:"mb-6"},_=["value"],O={class:"grid grid-cols-1 gap-4 mb-6"},j=["value"],B=["value"],P={class:"flex-1 p-6 overflow-auto"},U={class:"w-full text-sm text-left text-gray-500 bg-white rounded-lg shadow-sm"},V={class:"text-xs text-gray-700 uppercase bg-gray-100"},C={data(){return{tiposReporte:[{label:"General de Expedientes",value:"general"},{label:"Por Oficina",value:"oficina"},{label:"Por Entidad",value:"entidad"},{label:"Por Año Elaboración",value:"anio"},{label:"Por Estado Archivador",value:"estado"},{label:"Por Serie Documental",value:"serie"}],filtros:{oficina_id:"",entidad_id:"1"},oficinas:[],entidades:[],dataReportes:[],headers:[]}},methods:{async cargarMaestros(){const l=await c.get("/api/oficinaexcel");this.oficinas=l.data;const r=await c.get("/api/entidades");this.entidades=r.data},async fetchReporte(){try{const l=await c.get(`/api/reportes/${this.reporteSeleccionado}`,{params:this.filtros});console.log(l),this.dataReportes=l.data,this.headers=Object.keys(this.dataReportes[0]||{})}catch{g.fire("Error","No se pudo cargar el reporte","error")}},async exportarReporte(){if(!this.dataReportes.length)return g.fire("Atención","No hay datos para exportar","info");const l=new w.Workbook,r=l.addWorksheet("Reporte");r.columns=this.headers.map(d=>({header:d,key:d,width:20})),this.dataReportes.forEach(d=>r.addRow(d));const t=await l.xlsx.writeBuffer(),e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),p=document.createElement("a");p.href=URL.createObjectURL(e),p.download=`Reporte_${this.reporteSeleccionado}.xlsx`,p.click()}},mounted(){this.cargarMaestros()}},D=Object.assign(C,{__name:"Index",setup(l){return(r,t)=>(a(),s(i,null,[m(y(h),{title:"Reportes Documentales"}),m(v,null,{default:x(()=>[o("div",k,[o("div",E,[t[11]||(t[11]=o("h1",{class:"text-2xl font-bold text-gray-800 mb-6"},"Seleccionar Reporte",-1)),o("div",S,[t[5]||(t[5]=o("label",{class:"block text-sm font-semibold text-gray-600 mb-2"},"Tipo de Reporte",-1)),f(o("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.reporteSeleccionado=e),class:"text-sm w-full px-4 py-2 border border-red-300 rounded-lg focus:outline-none focus:border-red-500 hover:shadow"},[(a(!0),s(i,null,n(r.tiposReporte,e=>(a(),s("option",{key:e.value,value:e.value},u(e.label),9,_))),128))],512),[[b,r.reporteSeleccionado]])]),o("div",O,[o("div",null,[t[7]||(t[7]=o("label",{class:"block text-sm font-semibold text-gray-600 mb-2"},"Oficina",-1)),f(o("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.filtros.oficina_id=e),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-red-500"},[t[6]||(t[6]=o("option",{value:""},"Todas las oficinas",-1)),(a(!0),s(i,null,n(r.oficinas,e=>(a(),s("option",{key:e.id,value:e.id},u(e.nombre),9,j))),128))],512),[[b,r.filtros.oficina_id]])]),o("div",null,[t[9]||(t[9]=o("label",{class:"block text-sm font-semibold text-gray-600 mb-2"},"Entidad",-1)),f(o("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.filtros.entidad_id=e),class:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-red-500"},[t[8]||(t[8]=o("option",{value:""},"Todas las entidades",-1)),(a(!0),s(i,null,n(r.entidades,e=>(a(),s("option",{key:e.id,value:e.id},u(e.nombre),9,B))),128))],512),[[b,r.filtros.entidad_id]])])]),o("button",{onClick:t[3]||(t[3]=(...e)=>r.fetchReporte&&r.fetchReporte(...e)),class:"w-full bg-red-400 hover:bg-red-600 text-white py-3 rounded-md font-semibold shadow-md mb-2"}," Cargar Reporte "),o("button",{onClick:t[4]||(t[4]=(...e)=>r.exportarReporte&&r.exportarReporte(...e)),class:"w-full bg-gray-400 hover:bg-gray-700 rounded-md flex items-center justify-center py-2 text-xs text-white"},t[10]||(t[10]=[o("span",null,"Exportar Excel",-1)]))]),o("div",P,[o("table",U,[o("thead",V,[o("tr",null,[(a(!0),s(i,null,n(r.headers,e=>(a(),s("th",{key:e,class:"py-2 px-4"},u(e),1))),128))])]),o("tbody",null,[(a(!0),s(i,null,n(r.dataReportes,(e,p)=>(a(),s("tr",{key:p,class:"border-b hover:bg-gray-50"},[(a(!0),s(i,null,n(Object.values(e),d=>(a(),s("td",{key:d,class:"py-2 px-4"},u(d),1))),128))]))),128))])])])])]),_:1})],64))}}),G=R(D,[["__scopeId","data-v-a96345bf"]]);export{G as default};
