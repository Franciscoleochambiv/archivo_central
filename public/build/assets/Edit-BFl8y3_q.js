import{f as d,o as n,a as f,u as c,Z as b,w,b as s,d as v,t as u,i as a,F as m,m as p,l as t,p as l}from"./app-C4I9CGfi.js";import{_ as y}from"./AuthenticatedLayout-BMoADsr1.js";import{S as g}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./ApplicationLogo-l0EJvpch.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Chat-CHN7zPRk.js";import"./Ia-CK8R7IiL.js";const h={class:"mx-auto max-w-screen-xl w-full px-4 py-2 sm:px-6 lg:px-8"},x={class:"mx-auto max-w-full"},U={class:"max-w-5xl mx-auto p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md"},V={class:"text-center custom-paragraph text-lg font-medium bg-red-400 text-white rounded-full py-2 px-4"},A={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},E=["value"],k=["value"],C={class:"col-span-full"},D={class:"mb-2 space-y-1"},O={class:"text-sm text-gray-700"},B=["href"],P={data(){return{expedienteId:null,oficinas:[],entidades:[],archivos:[],importacion:!0,form:{oficina_id:"",entidad_id:"",periodo:"",anio_elaboracion:"",seccion:"",fechas_extremos:"",nro_archivo:"",unidad_conservacion:"",serie_documental:"",nro_comprobantes:"",ubicacion_estante:"",valor_serie_documental:"T",folios:"",soporte_papel:"",es_copia_original:1,anio_extremo_inicio:"",anio_extremo_fin:"",color:"",observaciones:"",estado_archivador:"B",ubicacion_actual:"A.C"}}},methods:{async cargarExpediente(){const i=await axios.get(`/api/expedientes/${this.expedienteId}`);console.log(i.data),this.form={...this.form,...i.data}},async cargarOficinas(){const i=await axios.get("/api/oficinaexcel");this.oficinas=i.data},async cargarEntidades(){const i=await axios.get("/api/entidades");this.entidades=i.data},handleArchivos(i){this.archivos=Array.from(i.target.files)},async actualizar(){this.importacion=!1;const i=new FormData;for(const e in this.form)i.append(e,this.form[e]);for(const e of this.archivos)i.append("documentos[]",e);await axios.post(`/api/expedientes/${this.expedienteId}?_method=PUT`,i).then(e=>{g.fire({title:"Mensaje",text:"Documento Grabado",icon:"success",timer:1e3,timerProgressBar:!0,showConfirmButton:!1}),this.importacion=!0,this.$inertia.visit("/listobras",{method:"get"})}).catch(e=>{this.importacion=!0,g.fire({icon:"error",title:"Error en la grabacion del documento",text:"Ocurrio un error al intentar grabar,"+e,confirmButtonText:"Aceptar"}).then(o=>{o.isConfirmed&&console.log("El usuario aceptó el mensaje de error.")})})}},mounted(){const i=window.location.pathname.split("/");this.expedienteId=i[i.length-1],this.cargarOficinas(),this.cargarEntidades(),this.cargarExpediente()}},z=Object.assign(P,{__name:"Edit",setup(i){return(e,o)=>(n(),d(m,null,[f(c(b),{title:"Edicion"}),f(y,null,{default:w(()=>[s("div",h,[s("div",x,[o[32]||(o[32]=s("h2",{class:"text-center text-2xl font-bold text-black-600 sm:text-3xl"},"Edición de Expediente",-1)),s("div",U,[s("form",{onSubmit:o[22]||(o[22]=v((...r)=>e.actualizar&&e.actualizar(...r),["prevent"])),enctype:"multipart/form-data"},[s("p",V," Usuario - "+u(e.$page.props.auth.user.name),1),s("div",A,[s("div",null,[o[23]||(o[23]=s("label",{class:"text-sm text-gray-600"},"Oficina",-1)),a(s("select",{"onUpdate:modelValue":o[0]||(o[0]=r=>e.form.oficina_id=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},[(n(!0),d(m,null,p(e.oficinas,r=>(n(),d("option",{value:r.id,key:r.id},u(r.nombre),9,E))),128))],512),[[t,e.form.oficina_id]])]),s("div",null,[o[24]||(o[24]=s("label",{class:"text-sm text-gray-600"},"Entidad",-1)),a(s("select",{"onUpdate:modelValue":o[1]||(o[1]=r=>e.form.entidad_id=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},[(n(!0),d(m,null,p(e.entidades,r=>(n(),d("option",{value:r.id,key:r.id},u(r.nombre),9,k))),128))],512),[[t,e.form.entidad_id]])]),a(s("input",{"onUpdate:modelValue":o[2]||(o[2]=r=>e.form.periodo=r),placeholder:"Periodo",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.periodo]]),a(s("input",{"onUpdate:modelValue":o[3]||(o[3]=r=>e.form.anio_elaboracion=r),placeholder:"Año elaboración",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.anio_elaboracion]]),a(s("input",{"onUpdate:modelValue":o[4]||(o[4]=r=>e.form.seccion=r),placeholder:"Sección",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.seccion]]),a(s("input",{type:"date","onUpdate:modelValue":o[5]||(o[5]=r=>e.form.fechas_extremos=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.fechas_extremos]]),a(s("input",{"onUpdate:modelValue":o[6]||(o[6]=r=>e.form.nro_archivo=r),placeholder:"Nro archivador",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.nro_archivo]]),a(s("input",{"onUpdate:modelValue":o[7]||(o[7]=r=>e.form.unidad_conservacion=r),placeholder:"Unidad conservación",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.unidad_conservacion]]),a(s("input",{"onUpdate:modelValue":o[8]||(o[8]=r=>e.form.serie_documental=r),placeholder:"Serie documental",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.serie_documental]]),a(s("input",{"onUpdate:modelValue":o[9]||(o[9]=r=>e.form.nro_comprobantes=r),placeholder:"Nro de Documento",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.nro_comprobantes]]),a(s("input",{"onUpdate:modelValue":o[10]||(o[10]=r=>e.form.ubicacion_estante=r),placeholder:"Ubicación estante",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.ubicacion_estante]]),a(s("select",{"onUpdate:modelValue":o[11]||(o[11]=r=>e.form.valor_serie_documental=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},o[25]||(o[25]=[s("option",{value:"T"},"Temporal",-1),s("option",{value:"P"},"Permanente",-1)]),512),[[t,e.form.valor_serie_documental]]),a(s("input",{"onUpdate:modelValue":o[12]||(o[12]=r=>e.form.folios=r),placeholder:"Folios",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.folios]]),a(s("input",{"onUpdate:modelValue":o[13]||(o[13]=r=>e.form.soporte_papel=r),placeholder:"Soporte papel",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.soporte_papel]]),a(s("select",{value:"0","onUpdate:modelValue":o[14]||(o[14]=r=>e.form.es_copia_original=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},o[26]||(o[26]=[s("option",{value:1},"ORIGINAL",-1),s("option",{value:0},"COPIA",-1)]),512),[[t,e.form.es_copia_original]]),a(s("input",{"onUpdate:modelValue":o[15]||(o[15]=r=>e.form.anio_extremo_inicio=r),placeholder:"Año extremo inicio",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.anio_extremo_inicio]]),a(s("input",{"onUpdate:modelValue":o[16]||(o[16]=r=>e.form.anio_extremo_fin=r),placeholder:"Año extremo fin",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.anio_extremo_fin]]),a(s("input",{"onUpdate:modelValue":o[17]||(o[17]=r=>e.form.color=r),placeholder:"Color",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.color]]),a(s("textarea",{"onUpdate:modelValue":o[18]||(o[18]=r=>e.form.observaciones=r),placeholder:"Observaciones",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[l,e.form.observaciones]]),a(s("select",{"onUpdate:modelValue":o[19]||(o[19]=r=>e.form.estado_archivador=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},o[27]||(o[27]=[s("option",{value:"B"},"Bueno",-1),s("option",{value:"M"},"Mal estado",-1),s("option",{value:"R"},"Regular",-1)]),512),[[t,e.form.estado_archivador]]),a(s("select",{"onUpdate:modelValue":o[20]||(o[20]=r=>e.form.ubicacion_actual=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},o[28]||(o[28]=[s("option",{value:"A.C"},"Archivo Central",-1),s("option",{value:"PRESTAMO"},"Préstamo",-1),s("option",{value:"DEVUELTO"},"Devuelto",-1)]),512),[[t,e.form.ubicacion_actual]]),s("div",C,[o[29]||(o[29]=s("label",{class:"text-sm text-gray-600 mb-1 block"},"Documentos adjuntos actuales",-1)),s("ul",D,[(n(!0),d(m,null,p(e.form.documentos,r=>(n(),d("li",{key:r.id,class:"flex items-center justify-between bg-gray-100 p-2 rounded"},[s("span",O,u(r.nombre),1),s("a",{href:`/storage/${r.ruta}`,class:"text-blue-600 hover:underline text-sm",target:"_blank",rel:"noopener"}," Descargar ",8,B)]))),128))]),o[30]||(o[30]=s("label",{class:"text-sm text-gray-600"},"Cambiar / agregar documentos",-1)),s("input",{type:"file",multiple:"",onChange:o[21]||(o[21]=(...r)=>e.handleArchivos&&e.handleArchivos(...r))},null,32)])]),o[31]||(o[31]=s("div",{class:"mt-4"},[s("button",{class:"bg-red-400 hover:bg-red-700 text-white px-4 py-2 rounded",type:"submit"},"Actualizar")],-1))],32)])])])]),_:1})],64))}});export{z as default};
