import{f as l,o as d,a as p,u as b,Z as v,w,b as s,d as f,t as u,i,F as m,m as g,l as t,p as a}from"./app-C4I9CGfi.js";import{_ as h}from"./AuthenticatedLayout-BMoADsr1.js";import{S as c}from"./sweetalert2.esm.all-BQIkj5Wb.js";import"./ApplicationLogo-l0EJvpch.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Chat-CHN7zPRk.js";import"./Ia-CK8R7IiL.js";const y={class:"mx-auto max-w-screen-xl w-full px-4 py-2 sm:px-6 lg:px-8"},x={class:"mx-auto max-w-full"},A={class:"max-w-5xl mx-auto p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md"},U={class:"text-center custom-paragraph text-lg font-medium bg-red-400 text-white rounded-full py-2 px-4"},V={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},C=["value"],E=["value"],R={class:"col-span-full"},D={key:0},O={key:1,class:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"},k={class:"mt-4 flex justify-between items-center"},B={class:"text-sm text-gray-600"},S={data(){return{oficinas:[],entidades:[],archivos:[],importacion:!0,total:0,form:{oficina_id:"",entidad_id:"",periodo:"",anio_elaboracion:"",seccion:"",fechas_extremos:"",nro_archivo:"",unidad_conservacion:"ARCHIVADOR DE PALANCA",serie_documental:"",nro_comprobantes:"",ubicacion_estante:"SEC.",valor_serie_documental:"P",folios:"",soporte_papel:"",es_copia_original:!0,anio_extremo_inicio:"",anio_extremo_fin:"",color:"",observaciones:"N/A",estado_archivador:"B",ubicacion_actual:"A.C"}}},methods:{async registrar(){this.importacion=!1;const n=new FormData;for(const e in this.form)n.append(e,this.form[e]);for(const e of this.archivos)n.append("documentos[]",e);await axios.post("/api/expedientes",n).then(e=>{c.fire({title:"Mensaje",text:"Documento Grabado",icon:"success",timer:1e3,timerProgressBar:!0,showConfirmButton:!1}),this.importacion=!0,this.actualizarConteo(),this.form={oficina_id:"",entidad_id:"",periodo:"",anio_elaboracion:"",seccion:"",fechas_extremos:"",nro_archivo:"",unidad_conservacion:"",serie_documental:"",nro_comprobantes:"",ubicacion_estante:"",valor_serie_documental:"T",folios:"",soporte_papel:"",es_copia_original:!0,anio_extremo_inicio:"",anio_extremo_fin:"",color:"",observaciones:"",estado_archivador:"B",ubicacion_actual:"A.C"},this.archivos=[],this.$refs.inputArchivos.value=""}).catch(e=>{this.importacion=!0,c.fire({icon:"error",title:"Error en la grabacion del documento",text:"Ocurrio un error al intentar grabar,"+e,confirmButtonText:"Aceptar"}).then(o=>{o.isConfirmed&&console.log("El usuario aceptó el mensaje de error.")})})},handleArchivos(n){this.archivos=Array.from(n.target.files)},async cargarOficinas(){const n=await axios.get("/api/oficinaexcel");this.oficinas=n.data},async cargarEntidades(){const n=await axios.get("/api/entidades");console.log("entidades"+n.data),this.entidades=n.data},async actualizarConteo(){if(!this.form.oficina_id)return;const n=await axios.get("/api/expedientes/oficina/"+this.form.oficina_id+"/conteo");this.total=n.data.total},verRegistros(){this.$inertia.visit("/listobras",{method:"get"})}},mounted(){this.cargarOficinas(),this.cargarEntidades()}},I=Object.assign(S,{__name:"Add",setup(n){return(e,o)=>(d(),l(m,null,[p(b(v),{title:"Dashboard"}),p(h,null,{default:w(()=>[s("div",y,[s("div",x,[o[34]||(o[34]=s("h2",{class:"text-center text-2xl font-bold text-black-600 sm:text-3xl"},"Registrar Nuevo Expediente",-1)),s("div",A,[s("form",{onSubmit:o[24]||(o[24]=f((...r)=>e.registrar&&e.registrar(...r),["prevent"])),enctype:"multipart/form-data"},[s("p",U," Usuario - "+u(e.$page.props.auth.user.name),1),s("div",V,[s("div",null,[o[25]||(o[25]=s("label",{class:"text-sm text-gray-600"},"Oficina",-1)),i(s("select",{"onUpdate:modelValue":o[0]||(o[0]=r=>e.form.oficina_id=r),onChange:o[1]||(o[1]=(...r)=>e.actualizarConteo&&e.actualizarConteo(...r)),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},[(d(!0),l(m,null,g(e.oficinas,r=>(d(),l("option",{value:r.id,key:r.id},u(r.nombre),9,C))),128))],544),[[t,e.form.oficina_id]])]),s("div",null,[o[26]||(o[26]=s("label",{class:"text-sm text-gray-600"},"Entidad",-1)),i(s("select",{"onUpdate:modelValue":o[2]||(o[2]=r=>e.form.entidad_id=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},[(d(!0),l(m,null,g(e.entidades,r=>(d(),l("option",{value:r.id,key:r.id},u(r.nombre),9,E))),128))],512),[[t,e.form.entidad_id]])]),i(s("input",{"onUpdate:modelValue":o[3]||(o[3]=r=>e.form.periodo=r),placeholder:"Periodo",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.periodo]]),i(s("input",{"onUpdate:modelValue":o[4]||(o[4]=r=>e.form.anio_elaboracion=r),placeholder:"Año elaboración",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.anio_elaboracion]]),i(s("input",{"onUpdate:modelValue":o[5]||(o[5]=r=>e.form.seccion=r),placeholder:"Sección",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.seccion]]),i(s("input",{type:"date","onUpdate:modelValue":o[6]||(o[6]=r=>e.form.fechas_extremos=r),placeholder:"Fechas extremos",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.fechas_extremos]]),i(s("input",{"onUpdate:modelValue":o[7]||(o[7]=r=>e.form.nro_archivo=r),placeholder:"Nro archivador",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.nro_archivo]]),i(s("input",{"onUpdate:modelValue":o[8]||(o[8]=r=>e.form.unidad_conservacion=r),placeholder:"Unidad conservación",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.unidad_conservacion]]),i(s("input",{"onUpdate:modelValue":o[9]||(o[9]=r=>e.form.serie_documental=r),placeholder:"Serie documental",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.serie_documental]]),i(s("input",{"onUpdate:modelValue":o[10]||(o[10]=r=>e.form.nro_comprobantes=r),placeholder:"Nro de Documento",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.nro_comprobantes]]),i(s("input",{"onUpdate:modelValue":o[11]||(o[11]=r=>e.form.ubicacion_estante=r),placeholder:"Ubicación estante",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.ubicacion_estante]]),i(s("select",{"onUpdate:modelValue":o[12]||(o[12]=r=>e.form.valor_serie_documental=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},o[27]||(o[27]=[s("option",{value:"T"},"Temporal",-1),s("option",{value:"P"},"Permanente",-1)]),512),[[t,e.form.valor_serie_documental]]),i(s("input",{"onUpdate:modelValue":o[13]||(o[13]=r=>e.form.folios=r),placeholder:"Folios",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.folios]]),i(s("input",{"onUpdate:modelValue":o[14]||(o[14]=r=>e.form.soporte_papel=r),placeholder:"Soporte papel",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.soporte_papel]]),i(s("select",{value:"0","onUpdate:modelValue":o[15]||(o[15]=r=>e.form.es_copia_original=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},o[28]||(o[28]=[s("option",{value:1},"ORIGINAL",-1),s("option",{value:0},"COPIA",-1)]),512),[[t,e.form.es_copia_original]]),i(s("input",{"onUpdate:modelValue":o[16]||(o[16]=r=>e.form.anio_extremo_inicio=r),placeholder:"Año extremo inicio",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.anio_extremo_inicio]]),i(s("input",{"onUpdate:modelValue":o[17]||(o[17]=r=>e.form.anio_extremo_fin=r),placeholder:"Año extremo fin",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.anio_extremo_fin]]),i(s("input",{"onUpdate:modelValue":o[18]||(o[18]=r=>e.form.color=r),placeholder:"Color",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.color]]),i(s("textarea",{"onUpdate:modelValue":o[19]||(o[19]=r=>e.form.observaciones=r),placeholder:"Observaciones",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},null,512),[[a,e.form.observaciones]]),i(s("select",{"onUpdate:modelValue":o[20]||(o[20]=r=>e.form.estado_archivador=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},o[29]||(o[29]=[s("option",{value:"B"},"Bueno",-1),s("option",{value:"M"},"Mal estado",-1),s("option",{value:"R"},"Regular",-1)]),512),[[t,e.form.estado_archivador]]),i(s("select",{"onUpdate:modelValue":o[21]||(o[21]=r=>e.form.ubicacion_actual=r),class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},o[30]||(o[30]=[s("option",{value:"A.C"},"Archivo Central",-1),s("option",{value:"PRESTAMO"},"Préstamo",-1),s("option",{value:"DEVUELTO"},"Devuelto",-1)]),512),[[t,e.form.ubicacion_actual]]),s("div",R,[o[31]||(o[31]=s("label",{class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 text-sm shadow-sm"},"Adjuntar documentos",-1)),s("input",{type:"file",multiple:"",ref:"inputArchivos",onChange:o[22]||(o[22]=(...r)=>e.handleArchivos&&e.handleArchivos(...r))},null,544)])]),e.importacion?(d(),l("div",D)):(d(),l("div",O,o[32]||(o[32]=[s("div",{class:"ml-2 absolute animate-spin rounded-full h-10 w-10 border-t-8 border-red-500"},null,-1)]))),s("div",k,[s("div",null,[o[33]||(o[33]=s("button",{class:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded",type:"submit"},"Registrar",-1)),s("button",{class:"ml-3 bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded",onClick:o[23]||(o[23]=f((...r)=>e.verRegistros&&e.verRegistros(...r),["prevent"]))},"Regresar")]),s("div",B,"Total registros: "+u(e.total),1)])],32)])])])]),_:1})],64))}});export{I as default};
