import{f as a,o as i,a as h,u as y,Z as k,w as _,b as e,i as M,p as E,F as u,m as f,t as d,g as b,n as C,y as v}from"./app-DpVbqR-c.js";import{_ as P}from"./AuthenticatedLayout-kXzuiwCY.js";import{S as p}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{u as c,w as T}from"./xlsx-DrgRuPKf.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-C-M4qhqN.js";import"./Chat-Bnf5azSk.js";import"./Ia-DSbK9_Ov.js";const j={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-9xl mx-auto"},D={class:"overflow-x-auto relative shadow-md sm:rounded-lg"},L={class:"relative"},S={id:"categoria",class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},$={class:"text-xs py-2 px-6"},I={class:"text-xs py-2 px-6"},A={class:"text-xs py-2 px-6"},V={class:"px-6 py-1"},z={class:"flex justify-end gap-4"},F=["href"],H=["onClick"],N={class:"pagination-controls mt-4 flex justify-center space-x-2"},O=["disabled"],q={key:0,class:"px-4 py-2"},R=["onClick"],U={key:1,class:"px-4 py-2"},W=["disabled"],Z={data(){return{movimientos:{data:[],prev_page_url:null,next_page_url:null,current_page:1,last_page:1},currentPage:1,searchTerm:"",isFetching:!1}},computed:{totalPages(){return this.movimientos.last_page},visiblePages(){const r=[],s=Math.max(1,this.currentPage-2),t=Math.min(this.totalPages,this.currentPage+2);for(let o=s;o<=t;o++)r.push(o);return r},showEllipsisBefore(){return this.visiblePages[0]>2},showEllipsisAfter(){return this.visiblePages[this.visiblePages.length-1]<this.totalPages-1}},methods:{async fetchMetas(r="/api/oficinast?page=1"){try{const s=await v.get(r,{params:{q:this.searchTerm}});this.movimientos=s.data,this.currentPage=this.movimientos.current_page}catch(s){console.error("Error fetching metas:",s)}},buscarMetas(){this.debounceTimeout&&clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(()=>{this.fetchMetas()},200)},async borrar(r){if((await p.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, borrarlo",cancelButtonText:"Cancelar",cancelButtonColor:"#d33"})).isConfirmed)try{await v.delete(`/api/oficina/${r}`),this.fetchMetas(),p.fire("Borrado","El movimiento ha sido eliminado correctamente","success")}catch(t){console.error("Error:",t),p.fire("Error","Hubo un problema al intentar borrar el movimiento","error")}},async exportToExcel(){const r=await fetch("/api/metaexcel");console.log(r);const t=(await r.json()).map(n=>({ID:n.id,Codigo:n.codigo,Descripcion:n.descripcion})),o=c.json_to_sheet(t),l=[{wch:8},{wch:8},{wch:150}];o["!cols"]=l;const g={alignment:{horizontal:"center",vertical:"center",wrapText:!0},font:{bold:!0}};["ID","Codigo","Descripcion"].forEach((n,x)=>{const w=c.encode_cell({r:0,c:x});o[w]={v:n,s:g}});const m=c.book_new();c.book_append_sheet(m,o,"Metas"),T(m,"metas.xlsx")}},mounted(){this.fetchMetas()}},G=Object.assign(Z,{__name:"Index",setup(r){return(s,t)=>(i(),a(u,null,[h(y(k),{title:"Dashboard"}),h(P,null,{default:_(()=>[e("div",j,[t[12]||(t[12]=e("h2",{class:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900"},"Listado de Oficinas",-1)),e("div",D,[t[10]||(t[10]=e("button",null,[e("a",{href:"/addmeta/","x-data":"{ tooltip: 'Añadir' }"},[e("div",{class:"h-10 w-10 bg-red-100 dark:bg-red-800/50 flex items-center justify-center rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",class:"w-5 h-5 stroke-red-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})])])])],-1)),e("button",{onClick:t[0]||(t[0]=(...o)=>s.exportToExcel&&s.exportToExcel(...o))},t[5]||(t[5]=[e("a",null,[e("div",{class:"h-10 w-10 bg-red-100 dark:bg-red-800/50 flex items-center justify-center rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",class:"w-5 h-5 stroke-red-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.75 14.5a.75.75 0 01-.75-.75V4.75c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75v9.622c0 .407-.325.74-.73.75H4.75zM6 6v9M10 6v9M14 6v9M18 6v5"})])])],-1)])),e("div",L,[t[6]||(t[6]=e("label",{for:"meta"},"Oficina: ",-1)),M(e("input",{type:"text",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 mt-3 mb-5 text-sm shadow-sm","onUpdate:modelValue":t[1]||(t[1]=o=>s.searchTerm=o),id:"entidad",name:"entidad",required:"",placeholder:"Buscar Oficina",autocomplete:"off",autofocus:"",onInput:t[2]||(t[2]=(...o)=>s.buscarMetas&&s.buscarMetas(...o))},null,544),[[E,s.searchTerm]])]),t[11]||(t[11]=e("h1",null,"Entidad",-1)),e("table",S,[t[9]||(t[9]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"py-3 px-6"},"Id"),e("th",{scope:"col",class:"py-3 px-6"},"Nombre"),e("th",{scope:"col",class:"py-3 px-6"},"Seccion"),e("th",{scope:"col",class:"py-3 px-6"},"Acciones")])],-1)),e("tbody",null,[(i(!0),a(u,null,f(s.movimientos.data,(o,l)=>(i(),a("tr",{key:l,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("td",$,d(o.id),1),e("td",I,d(o.nombre),1),e("td",A,d(o.seccion),1),e("td",V,[e("div",z,[e("button",null,[e("a",{href:`/editmeta/${o.id}`,"x-data":"{ tooltip: 'Editar' }"},t[7]||(t[7]=[e("div",{class:"h-10 w-10 bg-red-100 dark:bg-red-800/50 flex items-center justify-center rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",class:"w-5 h-5 stroke-red-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"})])],-1)]),8,F)]),e("button",{onClick:g=>s.borrar(o.id)},t[8]||(t[8]=[e("a",{"x-data":"{ tooltip: 'Eliminar' }"},[e("div",{class:"h-10 w-10 bg-red-100 dark:bg-red-800/50 flex items-center justify-center rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",class:"w-5 h-5 stroke-red-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})])])],-1)]),8,H)])])]))),128))])]),e("div",N,[e("button",{onClick:t[3]||(t[3]=o=>s.fetchMetas(s.movimientos.prev_page_url)),disabled:!s.movimientos.prev_page_url,class:"px-4 py-2 bg-red-100 dark:bg-red-800/50 text-gray-800 rounded hover:bg-gray-400"},"Anterior",8,O),s.showEllipsisBefore?(i(),a("span",q,"...")):b("",!0),(i(!0),a(u,null,f(s.visiblePages,o=>(i(),a("button",{key:o,onClick:l=>s.fetchMetas(`/api/oficinast?page=${o}`),class:C([{"px-4 py-2 bg-red-400 dark:bg-red-800/50 rounded hover:bg-red-600/10 text-white":s.currentPage===o,"bg-red-300 text-white-800":s.currentPage!==o},"px-4 py-2 bg-red-300 dark:bg-red-800/50 rounded hover:bg-red-600/50"])},d(o),11,R))),128)),s.showEllipsisAfter?(i(),a("span",U,"...")):b("",!0),e("button",{onClick:t[4]||(t[4]=o=>s.fetchMetas(s.movimientos.next_page_url)),disabled:!s.movimientos.next_page_url,class:"px-4 py-2 bg-red-100 dark:bg-red-800/50 rounded hover:bg-gray-400"},"Siguiente",8,W)])])])]),_:1})],64))}}),re=B(G,[["__scopeId","data-v-11ff264a"]]);export{re as default};
