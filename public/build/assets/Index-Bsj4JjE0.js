import{f as i,o as n,a as m,u as v,Z as y,w as k,b as e,i as _,p as M,F as u,m as b,t as l,g as x,n as E}from"./app-DpVbqR-c.js";import{_ as P}from"./AuthenticatedLayout-kXzuiwCY.js";import{S as p}from"./sweetalert2.esm.all-BQIkj5Wb.js";import{u as c,w as T}from"./xlsx-DrgRuPKf.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-C-M4qhqN.js";import"./Chat-Bnf5azSk.js";import"./Ia-DSbK9_Ov.js";const C={class:"px-4 sm:px-6 lg:px-8 py-8 w-full max-w-9xl mx-auto"},j={class:"overflow-x-auto relative shadow-md sm:rounded-lg"},L={class:"relative"},D={id:"categoria",class:"w-full text-sm text-left text-gray-500 dark:text-gray-400"},$={class:"text-xs py-2 px-6"},I={class:"text-xs py-2 px-6"},S={class:"text-xs py-2 px-6"},O={class:"text-xs py-2 px-6"},V={class:"text-xs py-2 px-6"},z={class:"text-xs py-2 px-6"},A={class:"px-6 py-1"},F={class:"flex justify-end gap-4"},H=["href"],R=["onClick"],N={class:"pagination-controls mt-4 flex justify-center space-x-2"},q=["disabled"],U={key:0,class:"px-4 py-2"},W=["onClick"],Z={key:1,class:"px-4 py-2"},G=["disabled"],J={data(){return{movimientos:{data:[],prev_page_url:null,next_page_url:null,current_page:1,last_page:1},currentPage:1,searchTerm:"",isFetching:!1}},computed:{totalPages(){return this.movimientos.last_page},visiblePages(){const r=[],o=Math.max(1,this.currentPage-2),t=Math.min(this.totalPages,this.currentPage+2);for(let s=o;s<=t;s++)r.push(s);return r},showEllipsisBefore(){return this.visiblePages[0]>2},showEllipsisAfter(){return this.visiblePages[this.visiblePages.length-1]<this.totalPages-1}},methods:{async fetchMetas(r="/api/obras?page=1"){try{const o=await axios.get(r,{params:{q:this.searchTerm}});this.movimientos=o.data,this.currentPage=this.movimientos.current_page}catch(o){console.error("Error fetching metas:",o)}},buscarMetas(){this.debounceTimeout&&clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout(()=>{this.fetchMetas()},200)},async borrar(r){if((await p.fire({title:"¿Estás seguro?",text:"Esta acción no se puede deshacer",icon:"warning",showCancelButton:!0,confirmButtonText:"Sí, borrarlo",cancelButtonText:"Cancelar",cancelButtonColor:"#d33"})).isConfirmed)try{await axios.delete(`/api/obra/${r}`),this.fetchMetas(),p.fire("Borrado","El movimiento ha sido eliminado correctamente","success")}catch(t){console.error("Error:",t),p.fire("Error","Hubo un problema al intentar borrar el movimiento","error")}},async exportToExcel(){const t=(await(await fetch("/api/obraexcel")).json()).map(a=>({ID:a.id,Descripcion:a.nombre,Latitud:a.latitud,Longitud:a.longitud,Radio:a.radio,Direccion:a.direccion})),s=c.json_to_sheet(t),d=[{wch:8},{wch:40},{wch:12},{wch:12},{wch:8},{wch:30}];s["!cols"]=d;const g={alignment:{horizontal:"center",vertical:"center",wrapText:!0},font:{bold:!0}};["ID","Descripcion","Latitud","Longitud","Radio","Direccion"].forEach((a,f)=>{const w=c.encode_cell({r:0,c:f});s[w]={v:a,s:g}});const h=c.book_new();c.book_append_sheet(h,s,"Obras"),T(h,"obras.xlsx")}},mounted(){this.fetchMetas()}},K=Object.assign(J,{__name:"Index",setup(r){return(o,t)=>(n(),i(u,null,[m(v(y),{title:"Cargos"}),m(P,null,{default:k(()=>[e("div",C,[t[12]||(t[12]=e("h2",{class:"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900"},"Listado de Obras",-1)),e("div",j,[t[10]||(t[10]=e("button",null,[e("a",{href:"/addobra/","x-data":"{ tooltip: 'Añadir' }"},[e("div",{class:"h-10 w-10 bg-red-100 dark:bg-red-800/50 flex items-center justify-center rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",class:"w-5 h-5 stroke-red-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})])])])],-1)),e("button",{onClick:t[0]||(t[0]=(...s)=>o.exportToExcel&&o.exportToExcel(...s))},t[5]||(t[5]=[e("a",null,[e("div",{class:"h-10 w-10 bg-red-100 dark:bg-red-800/50 flex items-center justify-center rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",class:"w-5 h-5 stroke-red-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.75 14.5a.75.75 0 01-.75-.75V4.75c0-.414.336-.75.75-.75h14.5c.414 0 .75.336.75.75v9.622c0 .407-.325.74-.73.75H4.75zM6 6v9M10 6v9M14 6v9M18 6v5"})])])],-1)])),e("div",L,[t[6]||(t[6]=e("label",{for:"meta"},"Obras: ",-1)),_(e("input",{type:"text",class:"w-full rounded-lg border-gray-300 focus:border-red-500 focus:ring-indigo-500 p-2 pe-12 mt-3 mb-5 text-sm shadow-sm","onUpdate:modelValue":t[1]||(t[1]=s=>o.searchTerm=s),id:"cargos",name:"cargos",required:"",placeholder:"Buscar Obras",autocomplete:"off",autofocus:"",onInput:t[2]||(t[2]=(...s)=>o.buscarMetas&&o.buscarMetas(...s))},null,544),[[M,o.searchTerm]])]),t[11]||(t[11]=e("h1",null,"Obras",-1)),e("table",D,[t[9]||(t[9]=e("thead",{class:"text-xs text-gray-700 uppercase bg-gray-50 dark:bg-gray-700 dark:text-gray-400"},[e("tr",null,[e("th",{scope:"col",class:"py-3 px-6"},"Id"),e("th",{scope:"col",class:"py-3 px-6"},"Descripcion"),e("th",{scope:"col",class:"py-3 px-6"},"Latitud"),e("th",{scope:"col",class:"py-3 px-6"},"Longitud"),e("th",{scope:"col",class:"py-3 px-6"},"Radio"),e("th",{scope:"col",class:"py-3 px-6"},"Direccion")])],-1)),e("tbody",null,[(n(!0),i(u,null,b(o.movimientos.data,(s,d)=>(n(),i("tr",{key:d,class:"bg-white border-b dark:bg-gray-800 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600"},[e("td",$,l(s.id),1),e("td",I,l(s.nombre),1),e("td",S,l(s.latitud),1),e("td",O,l(s.longitud),1),e("td",V,l(s.radio),1),e("td",z,l(s.direccion),1),e("td",A,[e("div",F,[e("button",null,[e("a",{href:`/editobra/${s.id}`,"x-data":"{ tooltip: 'Editar' }"},t[7]||(t[7]=[e("div",{class:"h-10 w-10 bg-red-100 dark:bg-red-800/50 flex items-center justify-center rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",class:"w-5 h-5 stroke-red-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125"})])],-1)]),8,H)]),e("button",{onClick:g=>o.borrar(s.id)},t[8]||(t[8]=[e("a",{"x-data":"{ tooltip: 'Eliminar' }"},[e("div",{class:"h-10 w-10 bg-red-100 dark:bg-red-800/50 flex items-center justify-center rounded-full"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",class:"w-5 h-5 stroke-red-500"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})])])],-1)]),8,R)])])]))),128))])]),e("div",N,[e("button",{onClick:t[3]||(t[3]=s=>o.fetchMetas(o.movimientos.prev_page_url)),disabled:!o.movimientos.prev_page_url,class:"px-4 py-2 bg-red-100 dark:bg-red-800/50 text-gray-800 rounded hover:bg-gray-400"},"Anterior",8,q),o.showEllipsisBefore?(n(),i("span",U,"...")):x("",!0),(n(!0),i(u,null,b(o.visiblePages,s=>(n(),i("button",{key:s,onClick:d=>o.fetchMetas(`/api/obras?page=${s}`),class:E([{"px-4 py-2 bg-red-400 dark:bg-red-800/50 rounded hover:bg-red-600/10 text-white":o.currentPage===s,"bg-red-300 text-white-800":o.currentPage!==s},"px-4 py-2 bg-red-300 dark:bg-red-800/50 rounded hover:bg-red-600/50"])},l(s),11,W))),128)),o.showEllipsisAfter?(n(),i("span",Z,"...")):x("",!0),e("button",{onClick:t[4]||(t[4]=s=>o.fetchMetas(o.movimientos.next_page_url)),disabled:!o.movimientos.next_page_url,class:"px-4 py-2 bg-red-100 dark:bg-red-800/50 rounded hover:bg-gray-400"},"Siguiente",8,G)])])])]),_:1})],64))}}),ie=B(K,[["__scopeId","data-v-30e7e0d2"]]);export{ie as default};
